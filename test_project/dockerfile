# Используем базовый образ golang
FROM golang:latest

# Устанавливаем рабочую директорию внутри контейнера
WORKDIR ./

# Копируем go.mod и go.sum и загружаем зависимости
COPY go.mod go.sum ./
RUN go mod download

# Копируем все файлы вашего приложения внутрь контейнера
COPY ./ ./

# Собираем приложение
RUN go build -o app .

# Используем минимальный образ для выполнения
FROM alpine:latest
WORKDIR /root/

# Копируем бинарный файл из предыдущего образа
COPY --from=builder /app/app .

# Указываем порт, который будет использоваться вашим приложением
EXPOSE 8080

# Запускаем приложение при старте контейнера
CMD ["./app"]